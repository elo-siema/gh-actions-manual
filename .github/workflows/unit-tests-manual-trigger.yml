name: Unit tests - manual trigger

on:
  workflow_dispatch:
    inputs:
      tests:
        description: Comma-separated list of tests to run. Runs all if empty. Accepts wildcards * . Just the name with no [] matches all parameter sets.
        required: false
      repeat:
        description: Number of times to repeat the tests. Defaults to 1.
        required: false
        default: 1

jobs:
  greet:
    runs-on: ubuntu-latest
    permissions:
      pull-requests: write
    steps:
      # Find the PR associated with this push, if there is one.
      - uses: jwalton/gh-find-current-pr@v1
        id: findPr
        with:
          # Can be "open", "closed", or "all".  Defaults to "open".
          state: open
      # This will echo "Your PR is 7", or be skipped if there is no current PR.
      - run: echo "Your PR is ${PR}"
        if: success() && steps.findPr.outputs.number
        env:
          PR: ${{ steps.findPr.outputs.pr }}

      - uses: mshick/add-pr-comment@v2
        with:
          message: |
            Hello in PR ${{ steps.findPr.outputs.pr }}!
            ${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }}

            
      - name: Send greeting
        run: echo "${{ github.event.inputs.tests }} ${{ github.event.inputs.repeat }}"
